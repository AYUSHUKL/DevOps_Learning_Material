ğŸ“¦ Terraform Modules â€“ The Ultimate Guide
ğŸ” What is a Terraform Module?
"A module is just a folder with Terraform configuration files."

Modules are reusable, self-contained units of Terraform code â€” just like functions in programming. They help you write DRY (Don't Repeat Yourself) infrastructure.

ğŸ¯ Why Use Modules?
ğŸ’¡ Reason	ğŸ’¬ Explanation
âœ… Reusability	Define once, reuse for dev, staging, prod
âœ… Maintainability	Centralize logic in one place
âœ… Abstraction	Hide complexity behind a simple interface
âœ… Scalability	Easily spin up multiple resources consistently
âœ… Team collaboration	Separate concerns using well-structured modules

ğŸ§± Module Types
Type	Description
Root Module	Your main configuration directory (where you run terraform apply)
Child Module	A module called from the root (or another module)
External Module	Pulled from Terraform Registry, GitHub, or a file path

ğŸ› ï¸ Module Structure
css
Copy
Edit
modules/
â””â”€â”€ ec2_instance/
    â”œâ”€â”€ main.tf
    â”œâ”€â”€ variables.tf
    â””â”€â”€ outputs.tf
âœ… How to Use a Module
hcl
Copy
Edit
module "web_server" {
  source        = "./modules/ec2_instance"
  instance_type = "t2.micro"
  ami_id        = "ami-12345678"
}
source can be:

Local path: "./modules/xyz"

GitHub: "git::https://github.com/user/repo//path"

Terraform Registry: "terraform-aws-modules/vpc/aws"

âœï¸ Inside a Module
variables.tf
hcl
Copy
Edit
variable "instance_type" {}
variable "ami_id" {}
main.tf
hcl
Copy
Edit
resource "aws_instance" "this" {
  ami           = var.ami_id
  instance_type = var.instance_type
}
outputs.tf
hcl
Copy
Edit
output "instance_id" {
  value = aws_instance.this.id
}
ğŸ“¤ Module Outputs
Access module outputs like this:

hcl
Copy
Edit
output "web_id" {
  value = module.web_server.instance_id
}
ğŸ’¼ Interview Use Cases
ğŸ’¬ Interview Question	âœ… Pro Tip Answer
â€œHow do you manage multi-environment deployments?â€	â€œI use modules with separate workspaces or terraform.tfvars files for dev/stage/prodâ€
â€œHow do you ensure consistency in large setups?â€	â€œBy using reusable modules published in private or public registriesâ€
â€œWhat if one module needs output from another?â€	â€œUse module.<name>.<output> to chain themâ€

âš ï¸ Best Practices
âœ… Use outputs.tf, variables.tf, and main.tf
âœ… Always pin versions of external modules
âœ… Use terraform-docs to document your module inputs/outputs
âœ… Keep modules focused â€” single responsibility principle
âœ… Validate with terraform validate and test with terraform plan

ğŸ§  Bonus: Module from Terraform Registry
hcl
Copy
Edit
module "vpc" {
  source  = "terraform-aws-modules/vpc/aws"
  version = "5.1.1"

  name = "my-vpc"
  cidr = "10.0.0.0/16"

  azs             = ["us-east-1a", "us-east-1b"]
  private_subnets = ["10.0.1.0/24", "10.0.2.0/24"]
}
Just plug and play â€” the registry module does the heavy lifting.

ğŸ§© Quick Recap
Concept	Keyword
Reusable block	Module
Main entry	Root module
Reusable child	Child module
Input params	variable block
Output values	output block
Remote source	Registry / Git




 Real-World Terraform Project Structure (with Modules & Environments)
css
Copy
Edit
terraform-project/
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ ec2/
â”‚   â”‚   â”œâ”€â”€ main.tf
â”‚   â”‚   â”œâ”€â”€ variables.tf
â”‚   â”‚   â””â”€â”€ outputs.tf
â”‚   â”œâ”€â”€ vpc/
â”‚   â”‚   â”œâ”€â”€ main.tf
â”‚   â”‚   â”œâ”€â”€ variables.tf
â”‚   â”‚   â””â”€â”€ outputs.tf
â”‚   â””â”€â”€ s3/
â”‚       â”œâ”€â”€ main.tf
â”‚       â”œâ”€â”€ variables.tf
â”‚       â””â”€â”€ outputs.tf
â”‚
â”œâ”€â”€ environments/
â”‚   â”œâ”€â”€ dev/
â”‚   â”‚   â”œâ”€â”€ main.tf
â”‚   â”‚   â”œâ”€â”€ variables.tf
â”‚   â”‚   â”œâ”€â”€ terraform.tfvars
â”‚   â”‚   â””â”€â”€ backend.tf
â”‚   â””â”€â”€ prod/
â”‚       â”œâ”€â”€ main.tf
â”‚       â”œâ”€â”€ variables.tf
â”‚       â”œâ”€â”€ terraform.tfvars
â”‚       â””â”€â”€ backend.tf
â”‚
â”œâ”€â”€ provider.tf
â””â”€â”€ versions.tf
ğŸ§± Sample Module Template: modules/ec2/
main.tf
hcl
Copy
Edit
resource "aws_instance" "this" {
  ami           = var.ami
  instance_type = var.instance_type
  tags = {
    Name = var.name
  }
}
variables.tf
hcl
Copy
Edit
variable "ami" {
  description = "AMI ID"
  type        = string
}

variable "instance_type" {
  description = "EC2 instance type"
  type        = string
  default     = "t2.micro"
}

variable "name" {
  description = "Name tag for the instance"
  type        = string
}
outputs.tf
hcl
Copy
Edit
output "instance_id" {
  value = aws_instance.this.id
}
ğŸŒ Sample Dev Environment: environments/dev/main.tf
hcl
Copy
Edit
provider "aws" {
  region = var.aws_region
}

module "ec2" {
  source        = "../../modules/ec2"
  ami           = var.ami
  instance_type = var.instance_type
  name          = "dev-ec2"
}
terraform.tfvars
hcl
Copy
Edit
aws_region     = "us-east-1"
ami            = "ami-0c55b159cbfafe1f0"
instance_type  = "t2.small"
variables.tf
hcl
Copy
Edit
variable "aws_region" {}
variable "ami" {}
variable "instance_type" {}
backend.tf (optional for remote state)
hcl
Copy
Edit
terraform {
  backend "s3" {
    bucket         = "my-terraform-state"
    key            = "dev/terraform.tfstate"
    region         = "us-east-1"
    dynamodb_table = "terraform-lock-table"
    encrypt        = true
  }
}
ğŸš€ How to Use
bash
Copy
Edit
cd environments/dev
terraform init
terraform plan
terraform apply
ğŸ” Same structure applies to prod/, just with different terraform.tfvars.

âœ… Benefits for Interviews & Teams
Benefit	Why It Impresses
âœ… Separation of concerns	Easy to manage per module/environment
âœ… Scalable & team-friendly	Devs can work in parallel
âœ… Reusable & DRY	Modules used across environments
âœ… Production-grade	Reflects what real companies do

